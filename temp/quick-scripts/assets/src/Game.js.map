{"version":3,"sources":["Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\src","sourcesContent":["import Player from \"./Player\";\r\n\r\n// Learn TypeScript:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/typescript.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\r\n//  - [English] http://www.cocos2d-x.org/docs/creator/manual/en/scripting/life-cycle-callbacks.html\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Game extends cc.Component {\r\n\r\n    @property(cc.Prefab)\r\n    starPrefab:cc.Prefab = null;\r\n    @property\r\n    maxStarDuration:number = 0;\r\n    @property\r\n    minStarDuration:number = 0;\r\n    @property(cc.Node)\r\n    ground:cc.Node = null;\r\n    @property(cc.Node)\r\n    player:cc.Node = null;\r\n    @property(cc.Label)\r\n    scoreDisplay:cc.Label = null;\r\n    @property(cc.AudioClip)\r\n    scoreAudio:cc.AudioClip = null;\r\n\r\n    private _groupY:number = 0;\r\n    private _score:number = 0;\r\n    private _timer:number = 0;\r\n    private _starDuration:number = 0;\r\n    // LIFE-CYCLE CALLBACKS:\r\n    get Timer():number{\r\n        return this._timer;\r\n    }\r\n    get StarDuration():number{\r\n        return this._starDuration;\r\n    }\r\n    onLoad () {\r\n        this._groupY = this.ground.y + this.ground.height/2;\r\n        this.spawNewStar();\r\n        this._score = 0;\r\n    }\r\n    spawNewStar(){\r\n        var newStar = cc.instantiate(this.starPrefab);\r\n        this.node.addChild(newStar);\r\n        newStar.setPosition(this.getNewStarPosition());\r\n        newStar.getComponent(\"Star\").game = this;\r\n        this._starDuration = this.minStarDuration + Math.random() * (this.maxStarDuration - this.minStarDuration);\r\n        this._timer = 0;\r\n    }\r\n    getNewStarPosition(){\r\n        var randX = 0;\r\n        var randY = this._groupY + Math.random() * this.player.getComponent('Player').jumpHeight +50;\r\n        var maxX = this.node.width /2;\r\n        randX = (Math.random() - 0.5) * 2 * maxX;\r\n        return cc.v2(randX,randY);\r\n    }\r\n    gainScore(){\r\n        this._score += 1;\r\n        this.scoreDisplay.string = 'Score:' + this._score;\r\n        cc.audioEngine.playEffect(this.scoreAudio,false);\r\n    }\r\n    start () {\r\n\r\n    }\r\n    gameOver(){\r\n        this.player.stopAllActions();\r\n        cc.director.loadScene('game');\r\n    }\r\n    update (dt) {\r\n        if(this._timer > this._starDuration){\r\n            this.gameOver();\r\n            return;\r\n        }\r\n        this._timer += dt;\r\n    }\r\n}\r\n"]}